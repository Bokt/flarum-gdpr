module.exports=function(t){var r={};function e(a){if(r[a])return r[a].exports;var o=r[a]={i:a,l:!1,exports:{}};return t[a].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=t,e.c=r,e.d=function(t,r,a){e.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:a})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,r){if(1&r&&(t=e(t)),8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(e.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var o in t)e.d(a,o,function(r){return t[r]}.bind(null,o));return a},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},e.p="",e(e.s=9)}([function(t,r){t.exports=flarum.core.compat["common/Model"]},function(t,r){t.exports=flarum.core.compat["components/Button"]},function(t,r){t.exports=flarum.core.compat["components/Modal"]},function(t,r){t.exports=flarum.core.compat.extend},function(t,r){t.exports=flarum.core.compat["components/SettingsPage"]},function(t,r){t.exports=flarum.core.compat["utils/extractText"]},function(t,r){t.exports=flarum.core.compat["utils/Stream"]},function(t,r){t.exports=flarum.core.compat["components/Page"]},function(t,r){t.exports=flarum.core.compat["utils/ItemList"]},function(t,r,e){"use strict";e.r(r);var a=e(3),o=e(0),s=e.n(o),n=e(7),u=e.n(n),p=e(4),i=e.n(p),c=e(1),l=e.n(c);function d(t,r){t.prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r}var f=e(2),b=e.n(f),h=function(t){function r(){return t.apply(this,arguments)||this}d(r,t);var e=r.prototype;return e.className=function(){return"RequestDataModal Modal--small"},e.title=function(){return app.translator.trans("blomstra-gdpr.forum.request_data.title")},e.content=function(){return m("div",{className:"Modal-body"},m("div",{className:"Form Form--centered"},m("p",{className:"helpText"},app.translator.trans("blomstra-gdpr.forum.request_data.text")),m("div",{className:"Form-group"},l.a.component({className:"Button Button--primary Button--block",type:"submit",loading:this.loading},app.translator.trans("blomstra-gdpr.forum.request_data.request_button")))))},e.onsubmit=function(t){t.preventDefault(),this.loading=!0,app.request({method:"POST",url:app.forum.attribute("apiUrl")+"/gdpr/export"}).then(this.hide.bind(this),this.loaded.bind(this))},r}(b.a),g=e(5),y=e.n(g),v=e(8),_=e.n(v),x=e(6),q=e.n(x),N=function(t){function r(){return t.apply(this,arguments)||this}d(r,t);var e=r.prototype;return e.oninit=function(r){t.prototype.oninit.call(this,r),this.reason=q()(""),this.password=q()("")},e.className=function(){return"RequestErasureModal Modal--small"},e.title=function(){return app.translator.trans("blomstra-gdpr.forum.request_erasure.title")},e.content=function(){return m("div",{className:"Modal-body"},m("div",{className:"Form Form--centered"},this.fields().toArray()))},e.fields=function(){var t=this,r=new _.a,e=app.session.user.erasureRequest();return e?(r.add("status",m("div",{className:"Form-group"},m("p",{className:"helpText"},app.translator.trans("blomstra-gdpr.forum.request_erasure.status."+e.status())))),e.reason()&&r.add("reason",m("div",{className:"Form-group"},m("p",{className:"helpText"},app.translator.trans("blomstra-gdpr.forum.request_erasure.reason",{reason:e.reason()})))),r.add("cancel",m("div",{className:"Form-group"},l.a.component({className:"Button Button--primary Button--block",onclick:this.oncancel.bind(this),loading:this.loading},app.translator.trans("blomstra-gdpr.forum.request_erasure.cancel_button"))))):(r.add("text",m("p",{className:"helpText"},app.translator.trans("blomstra-gdpr.forum.request_erasure.text"))),r.add("password",m("div",{className:"Form-group"},m("input",{type:"password",className:"FormControl",bidi:this.password,placeholder:y()(app.translator.trans("blomstra-gdpr.forum.request_erasure.password_label"))}))),r.add("reason",m("div",{className:"Form-group"},m("textarea",{className:"FormControl",value:this.reason(),oninput:function(r){return t.reason(r.target.value)},placeholder:y()(app.translator.trans("blomstra-gdpr.forum.request_erasure.reason_label"))}))),r.add("submit",m("div",{className:"Form-group"},l.a.component({className:"Button Button--primary Button--block",type:"submit",loading:this.loading},app.translator.trans("blomstra-gdpr.forum.request_erasure.request_button"))))),r},e.oncancel=function(t){var r=this;this.loading=!0,m.redraw(),app.session.user.erasureRequest().delete().then((function(){r.loading=!1,m.redraw()}))},e.data=function(){return{reason:this.reason(),status:"user_confirmed",relationships:{user:app.session.user}}},e.onsubmit=function(t){var r=this;t.preventDefault(),this.loading=!0,app.store.createRecord("user-erasure-requests").save(this.data(),{meta:{password:this.password()}}).then((function(t){app.session.user.pushData({relationships:{erasureRequest:t}}),r.loading=!1,m.redraw()})).catch((function(){r.loading=!1,m.redraw()}))},r}(b.a);function O(){return(O=Object.assign||function(t){for(var r=1;r<arguments.length;r++){var e=arguments[r];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])}return t}).apply(this,arguments)}var w=function(t){function r(){return t.apply(this,arguments)||this}return d(r,t),r}(s.a);O(w.prototype,{status:s.a.attribute("status"),reason:s.a.attribute("reason"),createdAt:s.a.attribute("createdAt",s.a.transformDate),userConfirmedAt:s.a.attribute("userConfirmedAt",s.a.transformDate),processedAt:s.a.attribute("processedAt",s.a.transformDate),processorComment:s.a.attribute("processorComment"),user:s.a.hasOne("user"),processedBy:s.a.hasOne("processedBy")}),app.initializers.add("blomstra-gdpr",(function(){app.store.models["user-erasure-requests"]=w,app.store.models.users.prototype.erasureRequest=s.a.hasOne("erasureRequest"),Object(a.extend)(u.a.prototype,"oninit",(function(){m.route.param("erasureRequestConfirmed")&&app.alerts.show({type:"success"},app.translator.trans("blomstra-gdpr.forum.erasure_request_confirmed"))})),Object(a.extend)(i.a.prototype,"accountItems",(function(t){t.add("gdprErasure",l.a.component({className:"Button",onclick:function(){return app.modal.show(N)}},app.translator.trans("blomstra-gdpr.forum.settings.request_erasure_button")))})),Object(a.extend)(i.a.prototype,"accountItems",(function(t){t.add("gdprExport",l.a.component({className:"Button",onclick:function(){return app.modal.show(h)}},app.translator.trans("blomstra-gdpr.forum.settings.export_data_button")))}))}))}]);
//# sourceMappingURL=forum.js.map